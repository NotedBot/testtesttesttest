<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NotedBot â”‚ Status</title>
    <link rel="icon" href="img/notedbotlogo.png" type="image/png">
    <link rel="stylesheet" href="./ressourcen/styles.css">
    <style>
        .rotate {
            display: inline-block;
            animation: rotateAnimation 2s linear infinite;
        }

        @keyframes rotateAnimation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }

        .status-content {
            font-size: 20px;
            color: #0036d8;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <a href="home.html"><img src="img/notedbot.gif" alt="NotedBot Logo"></a>
        </div>
        <div class="navigation">
            <h1 id="title"><img src="img/notedbotlogo.png" alt="NotedBot Logo" style="color: #0036d8;"> <span style="color: #0036d8;">NotedBot</span></h1>
            <ul>
                <li><a href="home" style="color: #4876ff;">Home</a></li>
                <li><a href="commands" style="color: #4876ff;">Commands</a></li>
                <li><a onclick="alert('Du bist doch schon auf der Seite?')" style="color: #4876ff;">Bot Status</a></li>
                <li><a href="paint?paintID=" style="color: #4876ff;">Try 7tv Paints</a></li>
                <li><a href="badge?badgeID=" style="color: #4876ff;">Try 7tv Badge</a></li>
            </ul>
        </div>
        <div id="error" class="hidden" style="font-size: 20px; color: #ff0000; text-align: center;">
            <img src="img/apu.png" alt="Error Image"> 
            <span style="color: #ff0000;">Error</span>
        </div>
        <div id="loading" class="hidden" style="font-size: 20px; color: #0036d8; text-align: center;">
            <img src="img/loading.gif" alt="Loading Image"> 
            <span style="color: #0036d8;">Status is Loading...</span>
        </div>
        <div class="command-bubble">
            <h3>All Requests</h3>
            <div id="status" class="status-content hidden" style="text-align: center;">
                <p id="ping"></p>
                <p id="helix-requests"></p>
                <p id="ivr-requests"></p>
                <p id="updated-at"></p>
            </div>
        </div>
        <script>
            async function loadStatus() {
                document.getElementById("loading").classList.remove("hidden");
                document.getElementById("status").classList.add("hidden");
                document.getElementById("error").classList.add("hidden");

                try {
                    const response = await fetch("https://raw.githubusercontent.com/NotedBot/testtesttesttest/main/ressourcen/status.json");
                    if (!response.ok) throw new Error(`Fehler beim fetchen: ${response.statusText}`);
                    
                    const data = await response.json();
                    
                    document.getElementById("ping").textContent = `Bot Ping: ${data.ping_ms}ms`;
                    document.getElementById("helix-requests").textContent = `Helix Requests: ${data.helix_requests}`;
                    document.getElementById("ivr-requests").textContent = `IVR Requests: ${data.ivr_requests}`;
                    document.getElementById("updated-at").textContent = `Last Update: ${new Date(data.updated_at).toLocaleString()}`;

                    document.getElementById("status").classList.remove("hidden");
                    document.getElementById("loading").classList.add("hidden");
                } catch (error) {
                    console.error("Error:", error);
                    document.getElementById("loading").classList.add("hidden");
                    document.getElementById("error").classList.remove("hidden");
                }
            }
            loadStatus();
        </script>      
    </div>
    <script src="./ressourcen/animation.js"></script>
</body>
</html>
